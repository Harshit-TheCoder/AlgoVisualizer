<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Bubble Sort Visualizer</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background-color: #f9fafb; /* light gray background */
      font-family: 'Segoe UI', Tahoma, sans-serif;
    }

    header {
      background: white;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
      padding: 1rem 0;
    }

    #bars {
      display: flex;
      align-items: flex-end;
      justify-content: center;
      height: 320px;
      padding: 1rem;
      background: white;
      border-radius: 0.5rem;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    }

    .bar {
      margin: 1px;
      width: 24px;
      background-color: #93c5fd;
      border-radius: 4px 4px 0 0;
      transition: transform 0.5s ease, background-color 0.3s ease;
    }

    .heading {
      font-size: 1.2rem;
      font-weight: 500;
      color: #374151;
      text-align: center;
      margin-bottom: 0.5rem;
    }

    .steps {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .step {
      display: flex;
      gap: 0.3rem;
      flex-wrap: wrap;
      justify-content: center;
    }

    .el {
      font-size: 0.9rem;
      color: white;
      min-width: 30px;
      height: 30px;
      background-color: #3b82f6;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 6px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
      transition: transform 0.5s ease-in-out;
    }

    .btn {
      background-color: #2563eb;
      color: white;
      padding: 0.6rem 1rem;
      border-radius: 6px;
      font-size: 0.9rem;
      font-weight: 500;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
      transition: background-color 0.3s ease;
    }

    .btn:hover {
      background-color: #1d4ed8;
    }
  </style>
</head>
<body class="min-h-screen text-black text-center">
   <header>
    <h1 class="text-3xl font-semibold text-center text-gray-800">Bubble Sort Visualizer</h1>
  </header>

  <main class="flex flex-row gap-8 max-w-7xl mx-auto py-8 px-6">
    <!-- Left panel -->
    <div class="flex flex-col gap-6 w-[40%]">
      <div>
        <div id="bars"></div>
      </div>
      <div class="flex justify-center gap-4">
        <button class="btn" onclick="generateBars()">Generate New Array</button>
        <button class="btn" onclick="bubbleSort()">Start Bubble Sort</button>
      </div>
    </div>

    <!-- Right panel -->
    <div class="flex flex-col w-[60%] gap-4">
      <h2 class="text-xl font-medium text-gray-700 text-center">Sorting Steps</h2>
      <div id="array" class="flex flex-wrap gap-2 justify-center"></div>
      <div id="steps" class="steps h-[600px] overflow-y-auto bg-white p-4 rounded-lg shadow-inner border border-gray-200"></div>
    </div>
  </main>

  <script>
    const barsContainer = document.getElementById("bars");
    const elementsContainer = document.getElementById("array");
    const stepsContainer = document.getElementById("steps");
    let array = [];

    function generateBars(size = 10) {
      array = [];
      barsContainer.innerHTML = "";
      elementsContainer.innerHTML = "";
      stepsContainer.innerHTML = "";

      for (let i = 0; i < size; i++) {
        const value = Math.floor(Math.random() * 100) + 5;
        array.push(value);

        const bar = document.createElement("div");
        bar.classList.add("bar");
        bar.style.height = `${value * 3}px`;

        const el = document.createElement("div");
        el.classList.add("el");
        el.innerText = value;

        barsContainer.appendChild(bar);
        elementsContainer.appendChild(el);
      }
    }

    async function bubbleSort() {
      let bars = barsContainer.getElementsByClassName("bar");
      let els = elementsContainer.getElementsByClassName("el");

      for (let i = 0; i < array.length - 1; i++) {
        const parentDiv = document.createElement("div");
        const list = document.createElement("div");
        list.classList.add("step");
        const heading  = document.createElement("h1");
        heading.classList.add("heading");
        heading.innerText = `After ${i+1} iteration`;
        parentDiv.appendChild(heading);

        for (let j = 0; j < array.length - i - 1; j++) {
          bars = barsContainer.getElementsByClassName("bar");
          els = elementsContainer.getElementsByClassName("el");

          bars[j].style.background = "yellow";
          bars[j + 1].style.background = "yellow";
          await sleep(500);

          if (array[j] > array[j + 1]) {
              bars[j].style.background = "red";
              bars[j + 1].style.background = "red";

              await Promise.all([
                  animateSwap(els[j], els[j + 1]), 
                  animateSwap(bars[j], bars[j + 1])
              ]);

              [array[j], array[j + 1]] = [array[j + 1], array[j]];

              elementsContainer.insertBefore(els[j + 1], els[j]);
              barsContainer.insertBefore(bars[j + 1], bars[j]);

              bars = barsContainer.getElementsByClassName("bar");
              els = elementsContainer.getElementsByClassName("el");
          }

          const elStep = document.createElement("div");
          elStep.classList.add("el");
          elStep.innerText = array[j];
          list.appendChild(elStep);

          bars[j].style.background = "#00c851";
          bars[j + 1].style.background = "#00c851";

          await sleep(200);
        }

        for (let j = array.length - i - 1; j < array.length; j++) {
          const elStep = document.createElement("div");
          elStep.classList.add("el");
          elStep.innerText = array[j];
          list.appendChild(elStep);
        }
        parentDiv.appendChild(list);
        stepsContainer.appendChild(parentDiv);

        bars[array.length - i - 1].style.background = "#00c851";
      }
      bars[0].style.background = "#00c851";
    }

    function animateSwap(el1, el2) {
        return new Promise(resolve => {
            const rect1 = el1.getBoundingClientRect();
            const rect2 = el2.getBoundingClientRect();
            const dx = rect2.left - rect1.left;

            el1.style.transform = `translateX(${dx}px)`;
            el2.style.transform = `translateX(${-dx}px)`;

            setTimeout(() => {
                el1.style.transform = "";
                el2.style.transform = "";
                resolve();
            }, 500);
        });
    }

    function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }

    generateBars();
  </script>
</body>
</html>
